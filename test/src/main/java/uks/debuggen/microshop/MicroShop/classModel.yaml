- c: 	org.fulib.classmodel.ClassModel
  classes: 	microShopModel 	microShopBusinessLogic 	microShopBuilder 	microShopService 	product 	order 	customer
  defaultCollectionType: 	c1
  defaultPropertyStyle: 	Bean
  defaultRoleType: 	"java.util.ArrayList<%s>"
  mainJavaDir: 	"test/src/main/java"
  packageName: 	uks.debuggen.microshop.MicroShop
  packageSrcFolder: 	"test/src/main/java/uks/debuggen/microshop/MicroShop"

- microShopModel: 	org.fulib.classmodel.Clazz
  attributes: 	microShopModel_modelMap
  importList: 	"import java.util.LinkedHashMap;"
  imports: 	"import java.util.LinkedHashMap;"
  methods: 	microShopModel_getOrCreateProduct 	microShopModel_getOrCreateOrder 	microShopModel_getOrCreateCustomer
  model: 	c
  modified: 	false
  name: 	MicroShopModel
  propertyStyle: 	Bean

- microShopBusinessLogic: 	org.fulib.classmodel.Clazz
  attributes: 	microShopBusinessLogic_model 	microShopBusinessLogic_handlerMap
  importList: 	"import java.util.LinkedHashMap;" 	"import java.util.function.Consumer;" 	"import uks.debuggen.microshop.events.*;"
  imports: 	"import java.util.LinkedHashMap;" 	"import java.util.function.Consumer;" 	"import uks.debuggen.microshop.events.*;"
  methods: 	microShopBusinessLogic_handleProductStoredEvent 	microShopBusinessLogic_handleDemoProductStoredEvent 	microShopBusinessLogic_handleAddOfferCommand 	microShopBusinessLogic_handleDemoAddOfferCommand 	microShopBusinessLogic_handleAddCommand 	microShopBusinessLogic_handleDemoAddCommand 	microShopBusinessLogic_handlePlaceCommand 	microShopBusinessLogic_handleDemoPlaceCommand 	microShopBusinessLogic_handlePickTaskCreatedEvent 	microShopBusinessLogic_handleDemoPickTaskCreatedEvent 	microShopBusinessLogic_handleOrderPickedEvent 	microShopBusinessLogic_handleDemoOrderPickedEvent 	microShopBusinessLogic_handleDeliverCommand 	microShopBusinessLogic_handleDemoDeliverCommand 	microShopBusinessLogic_initEventHandlerMap 	microShopBusinessLogic_ignoreEvent 	microShopBusinessLogic_getHandler
  model: 	c
  modified: 	false
  name: 	MicroShopBusinessLogic
  propertyStyle: 	Bean
  roles: 	microShopBusinessLogic_builder 	microShopBusinessLogic_service

- microShopBuilder: 	org.fulib.classmodel.Clazz
  attributes: 	microShopBuilder_model 	microShopBuilder_eventStore 	microShopBuilder_loaderMap 	microShopBuilder_groupStore
  importList: 	"import java.util.LinkedHashMap;" 	"import java.util.function.Consumer;" 	"import uks.debuggen.microshop.events.*;" 	"import java.util.function.Function;"
  imports: 	"import java.util.LinkedHashMap;" 	"import java.util.function.Consumer;" 	"import uks.debuggen.microshop.events.*;" 	"import java.util.function.Function;"
  methods: 	microShopBuilder_outdated 	microShopBuilder_storeProductBuilt 	microShopBuilder_loadProductBuilt 	microShopBuilder_storeOrderBuilt 	microShopBuilder_loadOrderBuilt 	microShopBuilder_storeCustomerBuilt 	microShopBuilder_loadCustomerBuilt 	microShopBuilder_load 	microShopBuilder_initLoaderMap 	microShopBuilder_getObjectId 	microShopBuilder_addToGroup 	microShopBuilder_stripBrackets
  model: 	c
  modified: 	false
  name: 	MicroShopBuilder
  propertyStyle: 	Bean
  roles: 	microShopBuilder_businessLogic 	microShopBuilder_service

- microShopService: 	org.fulib.classmodel.Clazz
  attributes: 	microShopService_history 	microShopService_port 	microShopService_spark 	microShopService_model
  importList: 	"import java.util.LinkedHashMap;" 	"import java.time.Instant;" 	"import java.time.format.DateTimeFormatter;" 	"import java.util.Map;" 	"import java.util.function.Consumer;" 	"import uks.debuggen.microshop.events.*;" 	"import org.fulib.yaml.Yaml;" 	"import org.fulib.yaml.YamlIdMap;" 	"import spark.Service;" 	"import spark.Request;" 	"import spark.Response;" 	"import com.mashape.unirest.http.HttpResponse;" 	"import com.mashape.unirest.http.Unirest;" 	"import com.mashape.unirest.http.exceptions.UnirestException;" 	"import java.util.concurrent.ExecutorService;" 	"import java.util.concurrent.Executors;" 	"import java.util.logging.Logger;" 	"import java.util.logging.Level;"
  imports: 	"import java.util.LinkedHashMap;" 	"import java.time.Instant;" 	"import java.time.format.DateTimeFormatter;" 	"import java.util.Map;" 	"import java.util.function.Consumer;" 	"import uks.debuggen.microshop.events.*;" 	"import org.fulib.yaml.Yaml;" 	"import org.fulib.yaml.YamlIdMap;" 	"import spark.Service;" 	"import spark.Request;" 	"import spark.Response;" 	"import com.mashape.unirest.http.HttpResponse;" 	"import com.mashape.unirest.http.Unirest;" 	"import com.mashape.unirest.http.exceptions.UnirestException;" 	"import java.util.concurrent.ExecutorService;" 	"import java.util.concurrent.Executors;" 	"import java.util.logging.Logger;" 	"import java.util.logging.Level;"
  methods: 	microShopService_query 	microShopService_isoNow 	microShopService_start 	microShopService_stop 	microShopService_getHello 	microShopService_subscribeAndLoadOldEvents 	microShopService_apply 	microShopService_getPage 	microShopService_getDemoPage 	microShopService_publish 	microShopService_postApply
  model: 	c
  modified: 	false
  name: 	MicroShopService
  propertyStyle: 	Bean
  roles: 	microShopService_businessLogic 	microShopService_builder

- product: 	org.fulib.classmodel.Clazz
  attributes: 	product_id 	product_name 	product_state 	product_price
  model: 	c
  modified: 	false
  name: 	Product
  propertyStyle: 	Bean
  roles: 	product_orders

- order: 	org.fulib.classmodel.Clazz
  attributes: 	order_id 	order_code 	order_address 	order_state
  model: 	c
  modified: 	false
  name: 	Order
  propertyStyle: 	Bean
  roles: 	order_product 	order_customer

- customer: 	org.fulib.classmodel.Clazz
  attributes: 	customer_id 	customer_name
  model: 	c
  modified: 	false
  name: 	Customer
  propertyStyle: 	Bean
  roles: 	customer_orders

- c1: 	org.fulib.classmodel.CollectionType
  implClass: 	class java.util.ArrayList
  implTemplate: 	"java.util.ArrayList<%s>"
  itf: 	org.fulib.classmodel.CollectionInterface.List
  qualifiedImplName: 	java.util.ArrayList
  simpleImplName: 	ArrayList

- microShopModel_modelMap: 	org.fulib.classmodel.Attribute
  clazz: 	microShopModel
  id: 	MicroShopModel_modelMap
  initialization: 	"new LinkedHashMap<>()"
  modified: 	false
  name: 	modelMap
  propertyStyle: 	Bean
  type: 	"LinkedHashMap<String, Object>"
  typeSignature: 	"LinkedHashMap<String,Object>"

- microShopModel_getOrCreateProduct: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopModel
  declaration: 	"public Product getOrCreateProduct(String id)"
  id: 	MicroShopModel_getOrCreateProduct
  methodBody: 	"if (id == null) return null;
return (Product) modelMap.computeIfAbsent(id, k -> new Product().setId(k));
"
  modified: 	false
  modifiers: 	public
  name: 	getOrCreateProduct
  paramsString: 	"String id"
  returnType: 	Product
  signature: 	"class/MicroShopModel/method/getOrCreateProduct(String)"

- microShopModel_getOrCreateOrder: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopModel
  declaration: 	"public Order getOrCreateOrder(String id)"
  id: 	MicroShopModel_getOrCreateOrder
  methodBody: 	"if (id == null) return null;
return (Order) modelMap.computeIfAbsent(id, k -> new Order().setId(k));
"
  modified: 	false
  modifiers: 	public
  name: 	getOrCreateOrder
  paramsString: 	"String id"
  returnType: 	Order
  signature: 	"class/MicroShopModel/method/getOrCreateOrder(String)"

- microShopModel_getOrCreateCustomer: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopModel
  declaration: 	"public Customer getOrCreateCustomer(String id)"
  id: 	MicroShopModel_getOrCreateCustomer
  methodBody: 	"if (id == null) return null;
return (Customer) modelMap.computeIfAbsent(id, k -> new Customer().setId(k));
"
  modified: 	false
  modifiers: 	public
  name: 	getOrCreateCustomer
  paramsString: 	"String id"
  returnType: 	Customer
  signature: 	"class/MicroShopModel/method/getOrCreateCustomer(String)"

- microShopBusinessLogic_model: 	org.fulib.classmodel.Attribute
  clazz: 	microShopBusinessLogic
  id: 	MicroShopBusinessLogic_model
  modified: 	false
  name: 	model
  propertyStyle: 	Bean
  type: 	MicroShopModel
  typeSignature: 	MicroShopModel

- microShopBusinessLogic_handlerMap: 	org.fulib.classmodel.Attribute
  clazz: 	microShopBusinessLogic
  id: 	MicroShopBusinessLogic_handlerMap
  modified: 	false
  name: 	handlerMap
  propertyStyle: 	Bean
  type: 	"LinkedHashMap<Class, Consumer<Event>>"
  typeSignature: 	"LinkedHashMap<Class,Consumer<Event>>"

- microShopBusinessLogic_handleProductStoredEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleProductStoredEvent(Event e)"
  id: 	MicroShopBusinessLogic_handleProductStoredEvent
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
ProductStoredEvent event = (ProductStoredEvent) e;
handleDemoProductStoredEvent(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handleProductStoredEvent
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleProductStoredEvent(Event)"

- microShopBusinessLogic_handleDemoProductStoredEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoProductStoredEvent(ProductStoredEvent event)"
  id: 	MicroShopBusinessLogic_handleDemoProductStoredEvent
  methodBody: 	"if (event.getId().equals(\"12:03\")) {
   ProductBuilt red_shoesEvent = new ProductBuilt();
   red_shoesEvent.setId(\"12:03:01\");
   red_shoesEvent.setBlockId(\"red_shoes\");
   red_shoesEvent.setName(\"red shoes\");
   red_shoesEvent.setState(\"in stock\");
   service.apply(red_shoesEvent);

}
if (event.getId().equals(\"12:06\")) {
   ProductBuilt red_shoesEvent = new ProductBuilt();
   red_shoesEvent.setId(\"12:06:01\");
   red_shoesEvent.setBlockId(\"red_shoes\");
   red_shoesEvent.setName(\"red shoes\");
   red_shoesEvent.setState(\"in stock\");
   service.apply(red_shoesEvent);

}
if (event.getId().equals(\"12:09\")) {
   ProductBuilt blue_jeansEvent = new ProductBuilt();
   blue_jeansEvent.setId(\"12:09:01\");
   blue_jeansEvent.setBlockId(\"blue_jeans\");
   blue_jeansEvent.setName(\"blue jeans\");
   blue_jeansEvent.setState(\"in stock\");
   service.apply(blue_jeansEvent);

}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoProductStoredEvent
  paramsString: 	"ProductStoredEvent event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoProductStoredEvent(ProductStoredEvent)"

- microShopBusinessLogic_handleAddOfferCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleAddOfferCommand(Event e)"
  id: 	MicroShopBusinessLogic_handleAddOfferCommand
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
AddOfferCommand event = (AddOfferCommand) e;
handleDemoAddOfferCommand(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handleAddOfferCommand
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleAddOfferCommand(Event)"

- microShopBusinessLogic_handleDemoAddOfferCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoAddOfferCommand(AddOfferCommand event)"
  id: 	MicroShopBusinessLogic_handleDemoAddOfferCommand
  methodBody: 	"if (event.getId().equals(\"12:14:42\")) {
   ProductBuilt red_shoesEvent = new ProductBuilt();
   red_shoesEvent.setId(\"12:14:43\");
   red_shoesEvent.setBlockId(\"red_shoes\");
   red_shoesEvent.setName(\"red shoes\");
   red_shoesEvent.setPrice(\"$42\");
   service.apply(red_shoesEvent);


   ProductOfferedEvent e1215 = new ProductOfferedEvent();

   e1215.setId(\"12:15\");
   e1215.setName(\"red shoes\");
   e1215.setPrice(\"$42\");
   service.apply(e1215);
}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoAddOfferCommand
  paramsString: 	"AddOfferCommand event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoAddOfferCommand(AddOfferCommand)"

- microShopBusinessLogic_handleAddCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleAddCommand(Event e)"
  id: 	MicroShopBusinessLogic_handleAddCommand
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
AddCommand event = (AddCommand) e;
handleDemoAddCommand(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handleAddCommand
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleAddCommand(Event)"

- microShopBusinessLogic_handleDemoAddCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoAddCommand(AddCommand event)"
  id: 	MicroShopBusinessLogic_handleDemoAddCommand
  methodBody: 	"if (event.getId().equals(\"12:17:01\")) {
   ProductBuilt blue_jeansEvent = new ProductBuilt();
   blue_jeansEvent.setId(\"12:17:02\");
   blue_jeansEvent.setBlockId(\"blue_jeans\");
   blue_jeansEvent.setName(\"blue jeans\");
   blue_jeansEvent.setPrice(\"$63\");
   service.apply(blue_jeansEvent);


   ProductOfferedEvent e1218 = new ProductOfferedEvent();

   e1218.setId(\"12:18\");
   e1218.setName(\"blue jeans\");
   e1218.setPrice(\"$63\");
   service.apply(e1218);
}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoAddCommand
  paramsString: 	"AddCommand event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoAddCommand(AddCommand)"

- microShopBusinessLogic_handlePlaceCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handlePlaceCommand(Event e)"
  id: 	MicroShopBusinessLogic_handlePlaceCommand
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
PlaceCommand event = (PlaceCommand) e;
handleDemoPlaceCommand(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handlePlaceCommand
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handlePlaceCommand(Event)"

- microShopBusinessLogic_handleDemoPlaceCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoPlaceCommand(PlaceCommand event)"
  id: 	MicroShopBusinessLogic_handleDemoPlaceCommand
  methodBody: 	"if (event.getId().equals(\"12:21:01\")) {
   OrderBuilt o0925_1Event = new OrderBuilt();
   o0925_1Event.setId(\"12:21:02\");
   o0925_1Event.setBlockId(\"o0925_1\");
   o0925_1Event.setCode(\"o0925_1\");
   o0925_1Event.setProduct(\"red shoes\");
   o0925_1Event.setCustomer(\"Carli Customer\");
   o0925_1Event.setAddress(\"Wonderland 1\");
   o0925_1Event.setState(\"new order\");
   service.apply(o0925_1Event);

   CustomerBuilt carli_CustomerEvent = new CustomerBuilt();
   carli_CustomerEvent.setId(\"12:21:03\");
   carli_CustomerEvent.setBlockId(\"Carli_Customer\");
   carli_CustomerEvent.setName(\"Carli Customer\");
   service.apply(carli_CustomerEvent);


   ProductOrderedEvent e1222 = new ProductOrderedEvent();

   e1222.setId(\"12:22\");
   e1222.setCode(\"o0925_1\");
   e1222.setProduct(\"red shoes\");
   e1222.setCustomer(\"Carli Customer\");
   e1222.setAddress(\"Wonderland 1\");
   service.apply(e1222);
}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoPlaceCommand
  paramsString: 	"PlaceCommand event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoPlaceCommand(PlaceCommand)"

- microShopBusinessLogic_handlePickTaskCreatedEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handlePickTaskCreatedEvent(Event e)"
  id: 	MicroShopBusinessLogic_handlePickTaskCreatedEvent
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
PickTaskCreatedEvent event = (PickTaskCreatedEvent) e;
handleDemoPickTaskCreatedEvent(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handlePickTaskCreatedEvent
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handlePickTaskCreatedEvent(Event)"

- microShopBusinessLogic_handleDemoPickTaskCreatedEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoPickTaskCreatedEvent(PickTaskCreatedEvent event)"
  id: 	MicroShopBusinessLogic_handleDemoPickTaskCreatedEvent
  methodBody: 	"if (event.getId().equals(\"12:23\")) {
   OrderBuilt o0925_1Event = new OrderBuilt();
   o0925_1Event.setId(\"12:23:01\");
   o0925_1Event.setBlockId(\"o0925_1\");
   o0925_1Event.setCode(\"o0925_1\");
   o0925_1Event.setState(\"picking\");
   service.apply(o0925_1Event);

}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoPickTaskCreatedEvent
  paramsString: 	"PickTaskCreatedEvent event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoPickTaskCreatedEvent(PickTaskCreatedEvent)"

- microShopBusinessLogic_handleOrderPickedEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleOrderPickedEvent(Event e)"
  id: 	MicroShopBusinessLogic_handleOrderPickedEvent
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
OrderPickedEvent event = (OrderPickedEvent) e;
handleDemoOrderPickedEvent(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handleOrderPickedEvent
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleOrderPickedEvent(Event)"

- microShopBusinessLogic_handleDemoOrderPickedEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoOrderPickedEvent(OrderPickedEvent event)"
  id: 	MicroShopBusinessLogic_handleDemoOrderPickedEvent
  methodBody: 	"if (event.getId().equals(\"12:27\")) {
   OrderBuilt o0925_1Event = new OrderBuilt();
   o0925_1Event.setId(\"12:27:01\");
   o0925_1Event.setBlockId(\"o0925_1\");
   o0925_1Event.setCode(\"o0925_1\");
   o0925_1Event.setState(\"shipping\");
   service.apply(o0925_1Event);

}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoOrderPickedEvent
  paramsString: 	"OrderPickedEvent event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoOrderPickedEvent(OrderPickedEvent)"

- microShopBusinessLogic_handleDeliverCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDeliverCommand(Event e)"
  id: 	MicroShopBusinessLogic_handleDeliverCommand
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
DeliverCommand event = (DeliverCommand) e;
handleDemoDeliverCommand(event);
"
  modified: 	false
  modifiers: 	private
  name: 	handleDeliverCommand
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDeliverCommand(Event)"

- microShopBusinessLogic_handleDemoDeliverCommand: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void handleDemoDeliverCommand(DeliverCommand event)"
  id: 	MicroShopBusinessLogic_handleDemoDeliverCommand
  methodBody: 	"if (event.getId().equals(\"12:30:01\")) {
   OrderBuilt o0925_1Event = new OrderBuilt();
   o0925_1Event.setId(\"12:30:02\");
   o0925_1Event.setBlockId(\"o0925_1\");
   o0925_1Event.setCode(\"o0925_1\");
   o0925_1Event.setState(\"delivered\");
   service.apply(o0925_1Event);


   OrderDeliveredEvent e1231 = new OrderDeliveredEvent();

   e1231.setId(\"12:31\");
   e1231.setOrder(\"o0925_1\");
   service.apply(e1231);
}
"
  modified: 	false
  modifiers: 	private
  name: 	handleDemoDeliverCommand
  paramsString: 	"DeliverCommand event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/handleDemoDeliverCommand(DeliverCommand)"

- microShopBusinessLogic_initEventHandlerMap: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"public void initEventHandlerMap()"
  id: 	MicroShopBusinessLogic_initEventHandlerMap
  methodBody: 	"if (handlerMap == null) {
   handlerMap = new LinkedHashMap<>();
   handlerMap.put(ProductBuilt.class, builder::storeProductBuilt);
   handlerMap.put(OrderBuilt.class, builder::storeOrderBuilt);
   handlerMap.put(CustomerBuilt.class, builder::storeCustomerBuilt);
   handlerMap.put(ProductStoredEvent.class, this::handleProductStoredEvent);
   handlerMap.put(AddOfferCommand.class, this::handleAddOfferCommand);
   handlerMap.put(AddCommand.class, this::handleAddCommand);
   handlerMap.put(PlaceCommand.class, this::handlePlaceCommand);
   handlerMap.put(PickTaskCreatedEvent.class, this::handlePickTaskCreatedEvent);
   handlerMap.put(OrderPickedEvent.class, this::handleOrderPickedEvent);
   handlerMap.put(DeliverCommand.class, this::handleDeliverCommand);
}
"
  modified: 	false
  modifiers: 	public
  name: 	initEventHandlerMap
  paramsString: 	""
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/initEventHandlerMap()"

- microShopBusinessLogic_ignoreEvent: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"private void ignoreEvent(Event event)"
  id: 	MicroShopBusinessLogic_ignoreEvent
  methodBody: 	"// empty
"
  modified: 	false
  modifiers: 	private
  name: 	ignoreEvent
  paramsString: 	"Event event"
  returnType: 	void
  signature: 	"class/MicroShopBusinessLogic/method/ignoreEvent(Event)"

- microShopBusinessLogic_getHandler: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBusinessLogic
  declaration: 	"public Consumer<Event> getHandler(Event event)"
  id: 	MicroShopBusinessLogic_getHandler
  methodBody: 	"return getHandlerMap().computeIfAbsent(event.getClass(), k -> this::ignoreEvent);
"
  modified: 	false
  modifiers: 	public
  name: 	getHandler
  paramsString: 	"Event event"
  returnType: 	"Consumer<Event>"
  signature: 	"class/MicroShopBusinessLogic/method/getHandler(Event)"

- microShopBusinessLogic_builder: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	microShopBusinessLogic
  id: 	MicroShopBusinessLogic_builder
  modified: 	false
  name: 	builder
  other: 	microShopBuilder_businessLogic
  propertyStyle: 	Bean

- microShopBusinessLogic_service: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	microShopBusinessLogic
  id: 	MicroShopBusinessLogic_service
  modified: 	false
  name: 	service
  other: 	microShopService_businessLogic
  propertyStyle: 	Bean

- microShopBuilder_model: 	org.fulib.classmodel.Attribute
  clazz: 	microShopBuilder
  id: 	MicroShopBuilder_model
  modified: 	false
  name: 	model
  propertyStyle: 	Bean
  type: 	MicroShopModel
  typeSignature: 	MicroShopModel

- microShopBuilder_eventStore: 	org.fulib.classmodel.Attribute
  clazz: 	microShopBuilder
  id: 	MicroShopBuilder_eventStore
  initialization: 	"new LinkedHashMap<>()"
  modified: 	false
  name: 	eventStore
  propertyStyle: 	Bean
  type: 	"LinkedHashMap<String, DataEvent>"
  typeSignature: 	"LinkedHashMap<String,DataEvent>"

- microShopBuilder_loaderMap: 	org.fulib.classmodel.Attribute
  clazz: 	microShopBuilder
  id: 	MicroShopBuilder_loaderMap
  modified: 	false
  name: 	loaderMap
  propertyStyle: 	Bean
  type: 	"LinkedHashMap<Class, Function<Event, Object>>"
  typeSignature: 	"LinkedHashMap<Class,Function<Event,Object>>"

- microShopBuilder_groupStore: 	org.fulib.classmodel.Attribute
  clazz: 	microShopBuilder
  id: 	MicroShopBuilder_groupStore
  initialization: 	"new LinkedHashMap<>()"
  modified: 	false
  name: 	groupStore
  propertyStyle: 	Bean
  type: 	"LinkedHashMap<String, LinkedHashMap<String, DataEvent>>"
  typeSignature: 	"LinkedHashMap<String,LinkedHashMap<String,DataEvent>>"

- microShopBuilder_outdated: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"private boolean outdated(DataEvent event)"
  id: 	MicroShopBuilder_outdated
  methodBody: 	"      DataEvent oldEvent = getEventStore().get(event.getBlockId());

      if (oldEvent == null) {
         eventStore.put(event.getBlockId(), event);
         return false;
      }

      if (oldEvent.getId().compareTo(event.getId()) < 0) {
         new org.fulib.yaml.Yamler2().mergeObjects(oldEvent, event);
         eventStore.put(event.getBlockId(), event);
         return false;
      }

      return true;"
  modified: 	false
  modifiers: 	private
  name: 	outdated
  paramsString: 	"DataEvent event"
  returnType: 	boolean
  signature: 	"class/MicroShopBuilder/method/outdated(DataEvent)"

- microShopBuilder_storeProductBuilt: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public void storeProductBuilt(Event e)"
  id: 	MicroShopBuilder_storeProductBuilt
  methodBody: 	"ProductBuilt event = (ProductBuilt) e;
if (outdated(event)) {
   return;
}
// please insert a no before fulib in the next line and insert addToGroup commands as necessary
// fulib
"
  modified: 	false
  modifiers: 	public
  name: 	storeProductBuilt
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBuilder/method/storeProductBuilt(Event)"

- microShopBuilder_loadProductBuilt: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public Product loadProductBuilt(Event e)"
  id: 	MicroShopBuilder_loadProductBuilt
  methodBody: 	"ProductBuilt event = (ProductBuilt) e;
Product object = model.getOrCreateProduct(event.getBlockId());
object.setName(event.getName());
object.setState(event.getState());
object.setPrice(event.getPrice());
return object;
"
  modified: 	false
  modifiers: 	public
  name: 	loadProductBuilt
  paramsString: 	"Event e"
  returnType: 	Product
  signature: 	"class/MicroShopBuilder/method/loadProductBuilt(Event)"

- microShopBuilder_storeOrderBuilt: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public void storeOrderBuilt(Event e)"
  id: 	MicroShopBuilder_storeOrderBuilt
  methodBody: 	"OrderBuilt event = (OrderBuilt) e;
if (outdated(event)) {
   return;
}
// please insert a no before fulib in the next line and insert addToGroup commands as necessary
// fulib
"
  modified: 	false
  modifiers: 	public
  name: 	storeOrderBuilt
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBuilder/method/storeOrderBuilt(Event)"

- microShopBuilder_loadOrderBuilt: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public Order loadOrderBuilt(Event e)"
  id: 	MicroShopBuilder_loadOrderBuilt
  methodBody: 	"OrderBuilt event = (OrderBuilt) e;
Order object = model.getOrCreateOrder(event.getBlockId());
object.setCode(event.getCode());
object.setProduct(model.getOrCreateProduct(event.getProduct()));
object.setCustomer(model.getOrCreateCustomer(event.getCustomer()));
object.setAddress(event.getAddress());
object.setState(event.getState());
return object;
"
  modified: 	false
  modifiers: 	public
  name: 	loadOrderBuilt
  paramsString: 	"Event e"
  returnType: 	Order
  signature: 	"class/MicroShopBuilder/method/loadOrderBuilt(Event)"

- microShopBuilder_storeCustomerBuilt: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public void storeCustomerBuilt(Event e)"
  id: 	MicroShopBuilder_storeCustomerBuilt
  methodBody: 	"CustomerBuilt event = (CustomerBuilt) e;
if (outdated(event)) {
   return;
}
// please insert a no before fulib in the next line and insert addToGroup commands as necessary
// fulib
"
  modified: 	false
  modifiers: 	public
  name: 	storeCustomerBuilt
  paramsString: 	"Event e"
  returnType: 	void
  signature: 	"class/MicroShopBuilder/method/storeCustomerBuilt(Event)"

- microShopBuilder_loadCustomerBuilt: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public Customer loadCustomerBuilt(Event e)"
  id: 	MicroShopBuilder_loadCustomerBuilt
  methodBody: 	"CustomerBuilt event = (CustomerBuilt) e;
Customer object = model.getOrCreateCustomer(event.getBlockId());
object.setName(event.getName());
return object;
"
  modified: 	false
  modifiers: 	public
  name: 	loadCustomerBuilt
  paramsString: 	"Event e"
  returnType: 	Customer
  signature: 	"class/MicroShopBuilder/method/loadCustomerBuilt(Event)"

- microShopBuilder_load: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public Object load(String blockId)"
  id: 	MicroShopBuilder_load
  methodBody: 	"      DataEvent dataEvent = eventStore.get(blockId);
      if (dataEvent == null) {
         return null;
      }

      initLoaderMap();
      Function<Event, Object> loader = loaderMap.get(dataEvent.getClass());
      Object object = loader.apply(dataEvent);

      LinkedHashMap<String, DataEvent> group = groupStore.computeIfAbsent(blockId, k -> new LinkedHashMap<>());
      for (DataEvent element : group.values()) {
         loader = loaderMap.get(element.getClass());
         loader.apply(element);
      }

      return object;"
  modified: 	false
  modifiers: 	public
  name: 	load
  paramsString: 	"String blockId"
  returnType: 	Object
  signature: 	"class/MicroShopBuilder/method/load(String)"

- microShopBuilder_initLoaderMap: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"private void initLoaderMap()"
  id: 	MicroShopBuilder_initLoaderMap
  methodBody: 	"if (loaderMap == null) {
   loaderMap = new LinkedHashMap<>();
   loaderMap.put(ProductBuilt.class, this::loadProductBuilt);
   loaderMap.put(OrderBuilt.class, this::loadOrderBuilt);
   loaderMap.put(CustomerBuilt.class, this::loadCustomerBuilt);
}
"
  modified: 	false
  modifiers: 	private
  name: 	initLoaderMap
  paramsString: 	""
  returnType: 	void
  signature: 	"class/MicroShopBuilder/method/initLoaderMap()"

- microShopBuilder_getObjectId: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public String getObjectId(String value)"
  id: 	MicroShopBuilder_getObjectId
  methodBody: 	"      if (value == null) {
         return null;
      }
      return value.replaceAll(\"\\W+\", \"_\");"
  modified: 	false
  modifiers: 	public
  name: 	getObjectId
  paramsString: 	"String value"
  returnType: 	String
  signature: 	"class/MicroShopBuilder/method/getObjectId(String)"

- microShopBuilder_addToGroup: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"private void addToGroup(String groupId, String elementId)"
  id: 	MicroShopBuilder_addToGroup
  methodBody: 	"      DataEvent dataEvent = eventStore.get(elementId);

      if (dataEvent == null) {
         java.util.logging.Logger.getGlobal().severe(String.format(\"could not find element event %s for group %s \", elementId, groupId));
         return;
      }

      LinkedHashMap<String, DataEvent> group = groupStore.computeIfAbsent(groupId, k -> new LinkedHashMap<>());
      group.put(elementId, dataEvent);"
  modified: 	false
  modifiers: 	private
  name: 	addToGroup
  paramsString: 	"String groupId, String elementId"
  returnType: 	void
  signature: 	"class/MicroShopBuilder/method/addToGroup(String,String)"

- microShopBuilder_stripBrackets: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopBuilder
  declaration: 	"public String stripBrackets(String back)"
  id: 	MicroShopBuilder_stripBrackets
  methodBody: 	"      if (back == null) {
         return \"\";
      }
      int open = back.indexOf('[');
      int close = back.indexOf(']');
      if (open >= 0 && close >= 0) {
         back = back.substring(open + 1, close);
      }
      return back;"
  modified: 	false
  modifiers: 	public
  name: 	stripBrackets
  paramsString: 	"String back"
  returnType: 	String
  signature: 	"class/MicroShopBuilder/method/stripBrackets(String)"

- microShopBuilder_businessLogic: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	microShopBuilder
  id: 	MicroShopBuilder_businessLogic
  modified: 	false
  name: 	businessLogic
  other: 	microShopBusinessLogic_builder
  propertyStyle: 	Bean

- microShopBuilder_service: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	microShopBuilder
  id: 	MicroShopBuilder_service
  modified: 	false
  name: 	service
  other: 	microShopService_builder
  propertyStyle: 	Bean

- microShopService_history: 	org.fulib.classmodel.Attribute
  clazz: 	microShopService
  id: 	MicroShopService_history
  initialization: 	"new LinkedHashMap<>()"
  modified: 	false
  name: 	history
  propertyStyle: 	Bean
  type: 	"LinkedHashMap<String, Event>"
  typeSignature: 	"LinkedHashMap<String,Event>"

- microShopService_port: 	org.fulib.classmodel.Attribute
  clazz: 	microShopService
  id: 	MicroShopService_port
  initialization: 	42002
  modified: 	false
  name: 	port
  propertyStyle: 	Bean
  type: 	int
  typeSignature: 	int

- microShopService_spark: 	org.fulib.classmodel.Attribute
  clazz: 	microShopService
  id: 	MicroShopService_spark
  modified: 	false
  name: 	spark
  propertyStyle: 	Bean
  type: 	Service
  typeSignature: 	Service

- microShopService_model: 	org.fulib.classmodel.Attribute
  clazz: 	microShopService
  id: 	MicroShopService_model
  modified: 	false
  name: 	model
  propertyStyle: 	Bean
  type: 	MicroShopModel
  typeSignature: 	MicroShopModel

- microShopService_query: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public Query query(Query query)"
  id: 	MicroShopService_query
  methodBody: 	"      DataEvent dataEvent = getBuilder().getEventStore().get(query.getKey());

      if (dataEvent == null) {
         return query;
      }

      if (dataEvent instanceof DataGroup) {
         DataGroup group = (DataGroup) dataEvent;
         query.withResults(group.getElements());
      }
      else {
         query.withResults(dataEvent);
      }

      return query;"
  modified: 	false
  modifiers: 	public
  name: 	query
  paramsString: 	"Query query"
  returnType: 	Query
  signature: 	"class/MicroShopService/method/query(Query)"

- microShopService_isoNow: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public String isoNow()"
  id: 	MicroShopService_isoNow
  methodBody: 	"return DateTimeFormatter.ISO_INSTANT.format(Instant.now());
"
  modified: 	false
  modifiers: 	public
  name: 	isoNow
  paramsString: 	""
  returnType: 	String
  signature: 	"class/MicroShopService/method/isoNow()"

- microShopService_start: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public void start()"
  id: 	MicroShopService_start
  methodBody: 	"Unirest.setTimeouts(3*60*1000, 3*60*1000);
model = new MicroShopModel();
setBuilder(new MicroShopBuilder().setModel(model));
setBusinessLogic(new MicroShopBusinessLogic());
businessLogic.setBuilder(getBuilder());
businessLogic.setModel(model);
ExecutorService executor = Executors.newSingleThreadExecutor();
spark = Service.ignite();
spark.port(port);
spark.get(\"/page/:id\", (req, res) -> executor.submit(() -> this.getPage(req, res)).get());
spark.get(\"/\", (req, res) -> executor.submit(() -> this.getHello(req, res)).get());
spark.post(\"/apply\", (req, res) -> executor.submit(() -> this.postApply(req, res)).get());
spark.init();
executor.submit(this::subscribeAndLoadOldEvents);
Logger.getGlobal().info(\"MicroShop service is up and running on port \" + port);
"
  modified: 	false
  modifiers: 	public
  name: 	start
  paramsString: 	""
  returnType: 	void
  signature: 	"class/MicroShopService/method/start()"

- microShopService_stop: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public void stop()"
  id: 	MicroShopService_stop
  methodBody: 	"spark.stop();
"
  modified: 	false
  modifiers: 	public
  name: 	stop
  paramsString: 	""
  returnType: 	void
  signature: 	"class/MicroShopService/method/stop()"

- microShopService_getHello: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"private String getHello(Request req, Response res)"
  id: 	MicroShopService_getHello
  methodBody: 	"try {
   String events = Yaml.encodeSimple(getHistory().values().toArray());
   String objects = Yaml.encodeSimple(model.getModelMap().values().toArray());
   return \"<p id='MicroShop'>This is the MicroShop service. </p>\n\" +
         \"<pre id=\\"history\\">\" + events + \"</pre>\n\" +
         \"<pre id=\\"data\\">\" + objects + \"</pre>\n\" +
         \"\";
}
catch (Exception e) {
   Logger.getGlobal().log(Level.SEVERE, e.getMessage(), e);
   return \"MicroShop Error \" + e.getMessage();
}
"
  modified: 	false
  modifiers: 	private
  name: 	getHello
  paramsString: 	"Request req, Response res"
  returnType: 	String
  signature: 	"class/MicroShopService/method/getHello(Request,Response)"

- microShopService_subscribeAndLoadOldEvents: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"private void subscribeAndLoadOldEvents()"
  id: 	MicroShopService_subscribeAndLoadOldEvents
  methodBody: 	"ServiceSubscribed serviceSubscribed = new ServiceSubscribed()
      .setServiceUrl(String.format(\"http://localhost:%d/apply\", port));
String json = Yaml.encodeSimple(serviceSubscribed);
try {
   String url = \"http://localhost:42000/subscribe\";
   HttpResponse<String> response = Unirest
         .post(url)
         .body(json)
         .asString();
   String body = response.getBody();
   YamlIdMap idMap = new YamlIdMap(Event.class.getPackageName());
   idMap.decode(body);
   Map<String, Object> objectMap = idMap.getObjIdMap();
   for (Object obj : objectMap.values()) {
      apply((Event) obj);
   }
}
catch (UnirestException e) {
   e.printStackTrace();
}"
  modified: 	false
  modifiers: 	private
  name: 	subscribeAndLoadOldEvents
  paramsString: 	""
  returnType: 	void
  signature: 	"class/MicroShopService/method/subscribeAndLoadOldEvents()"

- microShopService_apply: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public void apply(Event event)"
  id: 	MicroShopService_apply
  methodBody: 	"if (history.get(event.getId()) != null) {
   return;
}
businessLogic.initEventHandlerMap();
Consumer<Event> handler = businessLogic.getHandler(event);
handler.accept(event);
history.put(event.getId(), event);
firePropertyChange(PROPERTY_HISTORY, null, event);
publish(event);"
  modified: 	false
  modifiers: 	public
  name: 	apply
  paramsString: 	"Event event"
  returnType: 	void
  signature: 	"class/MicroShopService/method/apply(Event)"

- microShopService_getPage: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public String getPage(Request request, Response response)"
  id: 	MicroShopService_getPage
  methodBody: 	"// to protect manuel changes to this method insert a 'no' in front of fulib in the next line
// fulib
return getDemoPage(request, response);
"
  modified: 	false
  modifiers: 	public
  name: 	getPage
  paramsString: 	"Request request, Response response"
  returnType: 	String
  signature: 	"class/MicroShopService/method/getPage(Request,Response)"

- microShopService_getDemoPage: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public String getDemoPage(Request request, Response response)"
  id: 	MicroShopService_getDemoPage
  methodBody: 	"StringBuilder html = new StringBuilder();
String id = request.params(\"id\");
String event = request.queryParams(\"event\");

if (\"add offer 12:14:42\".equals(event)) {

   // create AddOfferCommand: add offer 12:14:42
   AddOfferCommand e121442 = new AddOfferCommand();
   e121442.setId(\"12:14:42\");
   e121442.setProduct(request.queryParams(\"product\"));
   e121442.setPrice(request.queryParams(\"price\"));
   apply(e121442);
}

if (\"add offer\".equals(event)) {

   // create AddCommand: add offer
   AddCommand e121701 = new AddCommand();
   e121701.setId(\"12:17:01\");
   e121701.setProduct(request.queryParams(\"product\"));
   e121701.setPrice(request.queryParams(\"price\"));
   apply(e121701);
}

if (\"place order\".equals(event)) {

   // create PlaceCommand: place order
   PlaceCommand e122101 = new PlaceCommand();
   e122101.setId(\"12:21:01\");
   e122101.setProduct(request.queryParams(\"product\"));
   e122101.setCustomer(request.queryParams(\"customer\"));
   e122101.setAddress(request.queryParams(\"address\"));
   apply(e122101);
}



// 12:11
if (id.equals(\"12_11\")) {
   html.append(\"<form action=\\"/page/12_12\\" method=\\"get\\">\n\");
   // MicroShop offers 12:11
   html.append(\"   <p>Offers overview</p>\n\");
   html.append(\"   <p><input id=\\"add\\" name=\\"button\\" type=\\"submit\\" value=\\"add\\"></p>\n\");
   html.append(\"   <p>no offers yet</p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:12
if (id.equals(\"12_12\")) {
   html.append(\"<form action=\\"/page/12_16\\" method=\\"get\\">\n\");
   // MicroShop add offer 12:12
   html.append(\"   <p>make new offer</p>\n\");
   html.append(\"   <p><input id=\\"product\\" name=\\"product\\" placeholder=\\"product?\\"></p>\n\");
   html.append(\"   <p><input id=\\"price\\" name=\\"price\\" placeholder=\\"price?\\"></p>\n\");
   html.append(\"   <p><input id=\\"event\\" name=\\"event\\" type=\\"hidden\\" value=\\"add offer 12:14:42\\"></p>\n\");
   html.append(\"   <p><input id=\\"ok\\" name=\\"button\\" type=\\"submit\\" value=\\"ok\\"></p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:16
if (id.equals(\"12_16\")) {
   html.append(\"<form action=\\"/page/12_17\\" method=\\"get\\">\n\");
   // MicroShop offers 12:16
   html.append(\"   <p>Offers overview</p>\n\");
   html.append(\"   <p><input id=\\"add\\" name=\\"button\\" type=\\"submit\\" value=\\"add\\"></p>\n\");
   html.append(\"   <p>red shoes, $42</p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:17
if (id.equals(\"12_17\")) {
   html.append(\"<form action=\\"/page/12_19\\" method=\\"get\\">\n\");
   // MicroShop add offer 12:17
   html.append(\"   <p>make new offer</p>\n\");
   html.append(\"   <p><input id=\\"product\\" name=\\"product\\" placeholder=\\"product?\\"></p>\n\");
   html.append(\"   <p><input id=\\"price\\" name=\\"price\\" placeholder=\\"price?\\"></p>\n\");
   html.append(\"   <p><input id=\\"event\\" name=\\"event\\" type=\\"hidden\\" value=\\"add offer\\"></p>\n\");
   html.append(\"   <p><input id=\\"ok\\" name=\\"button\\" type=\\"submit\\" value=\\"ok\\"></p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:19
if (id.equals(\"12_19\")) {
   html.append(\"<form action=\\"/page/next_page\\" method=\\"get\\">\n\");
   // MicroShop offers 12:19
   html.append(\"   <p>Offers overview</p>\n\");
   html.append(\"   <p><input id=\\"add\\" name=\\"button\\" type=\\"submit\\" value=\\"add\\"></p>\n\");
   html.append(\"   <p>red shoes, $42</p>\n\");
   html.append(\"   <p>blue jeans, $63</p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:20
if (id.equals(\"12_20\")) {
   html.append(\"<form action=\\"/page/12_21\\" method=\\"get\\">\n\");
   // MicroShop offers 12:20
   html.append(\"   <p>Welcome to our micro shop</p>\n\");
   html.append(\"   <p>We have</p>\n\");
   html.append(\"   <p>red shoes for $42</p>\n\");
   html.append(\"   <p>blue jeans for $63</p>\n\");
   html.append(\"   <p><input id=\\"order\\" name=\\"button\\" type=\\"submit\\" value=\\"order\\"></p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:21
if (id.equals(\"12_21\")) {
   html.append(\"<form action=\\"/page/12_24\\" method=\\"get\\">\n\");
   // MicroShop buy 12:21
   html.append(\"   <p>Welcome to our micro shop</p>\n\");
   html.append(\"   <p><input id=\\"product\\" name=\\"product\\" placeholder=\\"product?\\"></p>\n\");
   html.append(\"   <p><input id=\\"customer\\" name=\\"customer\\" placeholder=\\"customer?\\"></p>\n\");
   html.append(\"   <p><input id=\\"address\\" name=\\"address\\" placeholder=\\"address?\\"></p>\n\");
   html.append(\"   <p><input id=\\"event\\" name=\\"event\\" type=\\"hidden\\" value=\\"place order\\"></p>\n\");
   html.append(\"   <p><input id=\\"buy\\" name=\\"button\\" type=\\"submit\\" value=\\"buy\\"></p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}

// 12:24
if (id.equals(\"12_24\")) {
   html.append(\"<form action=\\"/page/next_page\\" method=\\"get\\">\n\");
   // MicroShop Carli overview 12:24
   html.append(\"   <p>Welcome Carli</p>\n\");
   html.append(\"   <p>Your orders are</p>\n\");
   html.append(\"   <p>red shoes for $42, picking</p>\n\");
   html.append(\"   <p><input id=\\"order\\" name=\\"button\\" type=\\"submit\\" value=\\"order\\"></p>\n\");
   html.append(\"</form>\n\");
   return html.toString();
}



html.append(\"This is the Shop Service page \" + id + \"\n\");
return html.toString();"
  modified: 	false
  modifiers: 	public
  name: 	getDemoPage
  paramsString: 	"Request request, Response response"
  returnType: 	String
  signature: 	"class/MicroShopService/method/getDemoPage(Request,Response)"

- microShopService_publish: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"public void publish(Event event)"
  id: 	MicroShopService_publish
  methodBody: 	"String json = Yaml.encodeSimple(event);

try {
   HttpResponse<String> response = Unirest
         .post(\"http://localhost:42000/publish\")
         .body(json)
         .asString();
}
catch (UnirestException e) {
   e.printStackTrace();
}"
  modified: 	false
  modifiers: 	public
  name: 	publish
  paramsString: 	"Event event"
  returnType: 	void
  signature: 	"class/MicroShopService/method/publish(Event)"

- microShopService_postApply: 	org.fulib.classmodel.FMethod
  annotations: 	""
  clazz: 	microShopService
  declaration: 	"private String postApply(Request req, Response res)"
  id: 	MicroShopService_postApply
  methodBody: 	"      String body = req.body();
      try {
         YamlIdMap idMap = new YamlIdMap(Event.class.getPackageName());
         idMap.decode(body);
         Map<String, Object> map = idMap.getObjIdMap();
         for (Object value : map.values()) {
            Event event = (Event) value;
            apply(event);
         }
      }
      catch (Exception e) {
         String message = e.getMessage();
         if (message.contains(\"ReflectorMap could not find class description\")) {
            Logger.getGlobal().info(\"post apply ignores unknown event \" + body);
         }
         else {
            Logger.getGlobal().log(Level.SEVERE, \"postApply failed\", e);
         }
      }
      return \"apply done\";"
  modified: 	false
  modifiers: 	private
  name: 	postApply
  paramsString: 	"Request req, Response res"
  returnType: 	String
  signature: 	"class/MicroShopService/method/postApply(Request,Response)"

- microShopService_businessLogic: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	microShopService
  id: 	MicroShopService_businessLogic
  modified: 	false
  name: 	businessLogic
  other: 	microShopBusinessLogic_service
  propertyStyle: 	Bean

- microShopService_builder: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	microShopService
  id: 	MicroShopService_builder
  modified: 	false
  name: 	builder
  other: 	microShopBuilder_service
  propertyStyle: 	Bean

- product_id: 	org.fulib.classmodel.Attribute
  clazz: 	product
  id: 	Product_id
  modified: 	false
  name: 	id
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- product_name: 	org.fulib.classmodel.Attribute
  clazz: 	product
  id: 	Product_name
  modified: 	false
  name: 	name
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- product_state: 	org.fulib.classmodel.Attribute
  clazz: 	product
  id: 	Product_state
  modified: 	false
  name: 	state
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- product_price: 	org.fulib.classmodel.Attribute
  clazz: 	product
  id: 	Product_price
  modified: 	false
  name: 	price
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- product_orders: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	42
  clazz: 	product
  collectionType: 	c1
  id: 	Product_orders
  modified: 	false
  name: 	orders
  other: 	order_product
  propertyStyle: 	Bean
  roleType: 	"java.util.ArrayList<%s>"

- order_id: 	org.fulib.classmodel.Attribute
  clazz: 	order
  id: 	Order_id
  modified: 	false
  name: 	id
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- order_code: 	org.fulib.classmodel.Attribute
  clazz: 	order
  id: 	Order_code
  modified: 	false
  name: 	code
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- order_address: 	org.fulib.classmodel.Attribute
  clazz: 	order
  id: 	Order_address
  modified: 	false
  name: 	address
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- order_state: 	org.fulib.classmodel.Attribute
  clazz: 	order
  id: 	Order_state
  modified: 	false
  name: 	state
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- order_product: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	order
  id: 	Order_product
  modified: 	false
  name: 	product
  other: 	product_orders
  propertyStyle: 	Bean

- order_customer: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	1
  clazz: 	order
  id: 	Order_customer
  modified: 	false
  name: 	customer
  other: 	customer_orders
  propertyStyle: 	Bean

- customer_id: 	org.fulib.classmodel.Attribute
  clazz: 	customer
  id: 	Customer_id
  modified: 	false
  name: 	id
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- customer_name: 	org.fulib.classmodel.Attribute
  clazz: 	customer
  id: 	Customer_name
  modified: 	false
  name: 	name
  propertyStyle: 	Bean
  type: 	String
  typeSignature: 	String

- customer_orders: 	org.fulib.classmodel.AssocRole
  aggregation: 	false
  cardinality: 	42
  clazz: 	customer
  collectionType: 	c1
  id: 	Customer_orders
  modified: 	false
  name: 	orders
  other: 	order_customer
  propertyStyle: 	Bean
  roleType: 	"java.util.ArrayList<%s>"

