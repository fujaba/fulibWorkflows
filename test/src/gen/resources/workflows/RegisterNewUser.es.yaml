
# =====================================================
- workflow: register new user

- action: Alice

- page:
    - name: PartyApp 12:00
    - label: Welcome to the parties
    - label: What's your name?
    - input: name
      fill: Alice
    - button: ok
      command: check name 12:01

- policy: PartyApp
  trigger: 12:01

- query: Alice 12:01:01
  result: []


- page:
    - name: PartyApp 12:02
    - label: Welcome Alice
    - label: You are new to parties
    - label: We need your email
    - input: email
      fill: a@b.de
    - button: ok
      command: check email 12:03

# - policy: PartyApp
#   trigger: 12:03

- query: Alice 12:03:01
  result: []


- page:
    - name: PartyApp 12:04
    - label: Welcome Alice
    - label: Choose a password
    - password: password
      fill: secret
    - button: ok
      command: check password 12:05

- query: Alice 12:05:01
  result: []

- data: 12:05:02
  user: Alice
  name: Alice
  email: a@b.de
  password: secret

- event: user registered 12:05:03
  name: Alice

- event: login succeeded 12:05:04
  name: Alice

- page:
    - name: PartyApp 12:06
    - label: Welcome Alice
    - label: Choose a party
    - input: party
      fill: SE BBQ
    - button: ok
      command: check party 12:07


# ======================================================
- workflow: login old user

- page:
    - name: PartyApp 13:00
    - label: Welcome to the parties
    - label: What's your name?
    - input: name
      fill: Alice
    - button: ok
      command: check name 13:01

- query: Alice 13:01:01
  result: [Alice]

- action: Alice

- page:
    - name: PartyApp 13:02
    - label: Welcome Alice
    - label: Provide a password
    - password: password
      fill: secret
    - button: ok
      command: check password 13:03

- query: Alice 13:03:01
  result: [Alice.secret]

- page:
    - name: PartyApp 13:04
    - label: Welcome Alice
    - label: Choose a party
    - input: party
      fill: SE BBQ
    - button: ok
      command: get party 13:05
