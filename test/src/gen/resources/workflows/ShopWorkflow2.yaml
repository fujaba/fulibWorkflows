# provide name for this scenario
# - workflow: ordering smooth

# provide some service with its port
- service: Shop
  port: 42100

# send event by default user somebody
- event: product stored 12:00
  box: box23
  product: shoes
  place: shelf23

# handle event by default service someservice
- data: 12:01
  box: box23
  product: shoes
  place: shelf23

# policy notes tell that the following actions are executed by a certain service triggered by a certain event
# let storage handle the event
- policy: Storage
  trigger: 12:00

- data: 12:02
  box: box23
  product: shoes
  place: shelf23

# following actions are created by Alice
- action: Alice

- page:
    - name: Shop 12:50
    - label: Welcome to the event shop
    - label: What do you want?
    - button: shoes
      command: Shop shoes selected 12:51
    - button: tshirt

- page:
    - name: Shop 13:00
    - label: welcome to the shop
    - input: product
      fill: shoes
    - input: name
      fill: Alice
    - input: address
      fill: Wonderland 1
    - button: OK
      command: order registered 13:01

# policy notes tell that the following actions are executed by a sertain service triggered by a certain event

- policy: Shop
  trigger: 13:01

- data: 13:02
  order: order1300
  product: shoes
  customer: Alice
  address: Wonderland 1
  state: pending

- data: 13:03
  customer: Alice
  orders: [ order1300 ]

- policy: Storage
  trigger: 13:01

- data: 13:04
  pickTask: pick1300
  order: order1300
  product: shoes
  customer: Alice
  address: Wonderland 1
  state: todo

- event: order approved 13:05
  order: order1300

- policy: Shop
  trigger: 13:05

- data: 13:06
  order: order1300
  state: picking

- action: Bob

- event: order picked 14:00
  pickTask: pick1300
  box: box23
  user: Bob

- policy: Storage
  trigger: 14:00

- data: 14:01
  pickTask: pick1300
  state: done
  box: box23

- data: 14:02
  box: box23
  place: shipping

- policy: Shop
  trigger: 14:00

- data: 14:03
  order: order1300
  state: shipping


- workflow: order out of stocks

- action: Alice

- event: order registered 13:11
  trigger: button OK
  product: tshirt
  customer: Alice
  address: Wonderland 1

- policy: Shop
  trigger: 13:11

- data: 13:12
  order: order1310
  product: tshirt
  customer: Alice
  address: Wonderland 1
  state: pending

- data: 13:13
  customer: Alice
  orders: [ order1300 order1310 ]

- policy: Storage
  trigger: 13:11

- event: order declined 13:14
  order: order1310

- policy: Shop
  trigger: 13:14

- data: 13:12
  order: order1310
  state: out of stock
